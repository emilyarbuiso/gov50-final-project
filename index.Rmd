---
title: "Gov 50 Final Project"
author: Emily Arbuiso
description: "Factors Contributing to New York's Air Pollution"
output:
  distill::distill_article:
    self_contained: false
---

## Introduction

Environmental issues are increasingly becoming important topics in politics, business, education, and everyday life. One such environmental issue is air pollution, which poses extreme risks to human health, biodiversity, entire ecosystems, and the normal functions of the planet. Their causes are important to understand, as human activities and systems are a major contributor to worsening climate conditions and changes. Which leads to the central research question of this project: Do different socioeconomic factors like unemployment rates, median household income, education levels, poverty, and population density impact levels of air pollution? Which of these factors, if any, impacts air pollution the most? To analyze these relationships, I will be examining data from the 62 counties of New York State. 

## Description of Data

My final dataset, called finalData, is composed of data taken from the [Office of the New York State Comptroller Website](https://www.osc.state.ny.us/local-government/data) and the [Environmental Protection Agency's Website](https://www.epa.gov/), and displays the following variables for the year 2021.

1. County = Full county name. 
2. Unemployment = Percentage of county that is unemployed.
3. MedianIncome = The median household income for the entire county, in dollars.
4. CollegeDegree = The proportion of the population that holds a college-level degree or higher. 
5. PM_2.5 = The level of fine particles with diameters of less than 2.5 micrometers in parts per million (ppm). PM_2.5 is a common air pollutant. 
6. Poverty = The percentage of the population of the county that is in poverty. 
7. PopDensity = The population density of the county, measured in persons per square mile. 

This data represents an observational study. This means that no treatment was given to any place or person, and thus data was collected through observation only. This is a cross sectional-research design, because it is taking data from one point in time, the year 2021, for a defined population of New York State. There are 62 counties total, and the dataset is not missing any values.

### Visualizing Air Pollution Levels 

```{r}

## loading data 

library(tidyverse)

finalData <- read_csv("finalData.csv")

## getting rid of extra columns 

finalData <- finalData |>
  select(County:PopDensity)

## distribution of air pollution

finalData |>
  ggplot(mapping = aes(x = PM)) +
  geom_histogram() +
  labs(x = "PM_2.5 Levels",
       y = "Frequency",
       title = "Frequency of PM_2.5 Levels Across NY State (2021)")
```
Here, we can see that most counties have PM_2.5 levels between 6 and 8 ppm. There are some counties that fall outside of this interval, with a maximum of 10.4 ppm and a minimum of 3.4 ppm. 

Next, we will analyze the relationships between PM_2.5 and each of the other factors discussed above to determine the potential correlations and their strengths, between air pollution and the socioeconomic factors. 

## Results 

### PM_2.5 and Population Density 

```{r}

## population density prediction

finalData |>
  ggplot(aes(x = PopDensity,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Population Density",
       y = "PM_2.5 Levels",
       title = "PM_2.5 Levels vs. Population Density in NY Counties")

## population density regression

pop_reg <- lm(PM ~ PopDensity, data = finalData)
pop_reg

## correlation

cor(finalData$PopDensity, finalData$PM) 


```
By looking at the graph, we can see that there appears to be a correlation between Population Density and PM_2.5 levels. There is a positive relationship between the two variables, as indicated by the line of best fit on the graph above. Generally, as population density increases, PM_2.5 levels also increase. 

The regression further supports this observation. The correlation coefficient for this regression is 4.932e-05, which means that as population density increases by 1 unit (1 person per square mile), PM_2.5 levels increase by 4.932e-05 ppm. This number is small, but this was expected as there is a large range in population density.

Finally, the correlation coefficient between the two variables was calculated to be about 0.520, which indicates a moderate association between the two variables. 

### PM_2.5 and Unemployment 

```{r}

## Unemployment prediction

finalData |>
  ggplot(aes(x = Unemployment,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Unemployment",
       y = "PM_2.5 Levels",
       title = "PM_2.5 Levels vs. Unemployment in NY Counties")

## unemployment regression

unemployment_reg <- lm(PM ~ Unemployment, data = finalData)
unemployment_reg

## correlation 

cor(finalData$Unemployment, finalData$PM)

```
By looking at the graph, we can see that there appears to be a correlation between Unemployment and PM_2.5 levels. There is a positive relationship between the two variables, as indicated by the line of best fit on the graph above. Generally, as Unemployment increases, PM_2.5 levels also increase. 

The regression further supports this observation. The correlation coefficient for this regression is 0.2265, which means that as unemployment increases by 1 unit (1 percentage), PM_2.5 levels increase by 0.2265 ppm. 

Finally, the correlation coefficient between the two variables was calculated to be about 0.344, which indicates a weak association between the two variables. 

### PM_2.5 and Median Income

```{r}

## Median Income prediction

finalData |>
  ggplot(aes(x = MedianIncome,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Median Income",
       y = "PM_2.5 Levels",
       title = "PM_2.5 Levels vs. Median Income in NY Counties")

## unemployment regression

income_reg <- lm(PM ~ MedianIncome, data = finalData)
income_reg

## correlation 

cor(finalData$MedianIncome, finalData$PM)


```
By looking at the graph, we can see that there appears to be a slight correlation between Median Income and PM_2.5 levels. There is a positive relationship between the two variables, as indicated by the line of best fit on the graph above. Generally, as Median Income increases, PM_2.5 levels also increase. 

The regression further supports this observation. The correlation coefficient for this regression is 2.578e-05, which means that as Median Income increases by 1 unit (1 dollar), PM_2.5 levels increase by 2.578e-05 ppm. This number is small, but this was expected as there is a large range in median income, similar to population density.

Finally, the correlation coefficient between the two variables was calculated to be about 0.253, which indicates a weak association between the two variables. 

### PM_2.5 and Education

```{r}

## Education prediction

finalData |>
  ggplot(aes(x = CollegeDegree,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "College Degree",
       y = "PM_2.5 Levels",
       title = "PM_2.5 Levels vs. Education in NY Counties")

## education regression

income_reg <- lm(PM ~ CollegeDegree, data = finalData)
income_reg

## correlation 

cor(finalData$CollegeDegree, finalData$PM)

```
By looking at the graph, we can see that there appears to be a correlation between Education and PM_2.5 levels. There is a positive relationship between the two variables, as indicated by the line of best fit on the graph above. Generally, as Education increases, PM_2.5 levels also increase. 

The regression further supports this observation. The correlation coefficient for this regression is 5.040, which means that as Education increases by 1 unit (1 percentage), PM_2.5 levels increase by 5.040 ppm. 

Finally, the correlation coefficient between the two variables was calculated to be about 0.458, which indicates a moderate association between the two variables. 

### PM_2.5 and Poverty

```{r}

## Poverty prediction

finalData |>
  ggplot(aes(x = Poverty,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Poverty",
       y = "PM_2.5 Levels",
       title = "PM_2.5 Levels vs. Poverty in NY Counties")

## poverty regression

income_reg <- lm(PM ~ Poverty, data = finalData)
income_reg

## correlation 

cor(finalData$Poverty, finalData$PM)

```
By looking at the graph, we can see that there appears to be little correlation between Poverty and PM_2.5 levels, as indicated by the almost horizontal line of best fit on the graph above. 

The correlation coefficient for this regression is 0.02879, which means that as Poverty increases by 1 unit (1 percentage), PM_2.5 levels increase by 0.02879 ppm. 

Finally, the correlation coefficient between the two variables was calculated to be about 0.085, which indicates a very weak association between the two variables.

### Multiple Regression

```{r}

## multiple regression

multi_reg <- lm(PM ~ Unemployment + MedianIncome + CollegeDegree + Poverty + PopDensity, data = finalData)
multi_reg

## creating table

install.packages("modelsummary", repos = "http://cran.us.r-project.org")
library(modelsummary)

modelsummary::modelsummary(multi_reg,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))


```

