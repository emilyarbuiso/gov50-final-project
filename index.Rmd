---
title: "Gov 50 Final Project"
author: Emily Arbuiso
description: "Factors Contributing to New York's Air Pollution"
output:
  distill::distill_article:
    self_contained: false
---

## Introduction

Environmental issues are increasingly becoming important topics in politics, business, education, and everyday life. One such environmental issue is air pollution, which poses extreme risks to human health, biodiversity, entire ecosystems, and the normal functions of the planet. Their causes are important to understand, as human activities and systems are a major contributor to worsening climate conditions and changes. Which leads to the central research question of this project: Do different socioeconomic factors like unemployment rates, median household income, education levels, poverty, and population density impact levels of air pollution? Which of these factors, if any, impacts air pollution the most? To analyze these relationships, I will be examining data from the 62 counties of New York State. 

## Description of Data

My final dataset, called finalData, is composed of data taken from the [Office of the New York State Comptroller Website](https://www.osc.state.ny.us/local-government/data) and the [Environmental Protection Agency's Website](https://www.epa.gov/), and displays the following variables for the year 2021.

1. County = Full county name. 
2. Unemployment = Percentage of county that is unemployed.
3. MedianIncome = The median household income for the entire county, in dollars.
4. CollegeDegree = The proportion of the population that holds a college-level degree or higher. 
5. PM_2.5 = The level of fine particles with diameters of less than 2.5 micrometers in parts per million (ppm). PM_2.5 is a common air pollutant. 
6. Poverty = The percentage of the population of the county that is in poverty. 
7. PopDensity = The population density of the county, measured in persons per square mile. 

This data represents an observational study. This means that no treatment was given to any place or person, and thus data was collected through observation only. This is a cross sectional-research design, because it is taking data from one point in time, the year 2021, for a defined population of New York State. There are 62 counties total, and the dataset is not missing any values.

### Visualizing Air Pollution Levels 

```{r}

## Loading data 

library(tidyverse)

finalData <- read_csv("finalData.csv")

## Tidying dataset 

finalData <- finalData |>
  select(County:PopDensity)

## Distribution of air pollution

finalData |>
  ggplot(mapping = aes(x = PM)) +
  geom_histogram() +
  labs(x = "PM_2.5 Levels (ppm)",
       y = "Frequency",
       title = "Frequency of PM_2.5 Levels Across NY Counties (2021)")

```
Here, we can see that most counties have PM_2.5 levels between 6 and 8 ppm. There are some counties that fall outside of this interval, with a maximum of 10.4 ppm and a minimum of 3.4 ppm. 

Next, we will analyze the relationships between PM_2.5 and each of the other factors discussed above to determine the potential correlations and their strengths, between air pollution and the socioeconomic factors. 

## Results 

### PM_2.5 and Population Density 

```{r}

## Population density graph

finalData |>
  ggplot(aes(x = PopDensity,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Population Density",
       y = "PM_2.5 Levels",
       title = "PM_2.5 Levels vs. Population Density in NY Counties")

## Population density regression

pop_reg <- lm(PM ~ PopDensity, data = finalData)
pop_reg

## Population density correlation

cor(finalData$PopDensity, finalData$PM) 

```
The graph indicates a positive correlation between Population Density and PM_2.5 levels. This can be seen through the line of best fit, represented by the red line. Generally, as population density increases, PM_2.5 levels also increase. The regression results further support this observation. The coefficient for this regression is 4.932e-05 (or 0.00004932). This means that as population density increases by 1 unit (1 person per square mile), PM_2.5 levels increase by 4.932e-05 ppm. This number is small, but because there is such a large range in population density, such a number is expected. Finally, the correlation coefficient (a measure of the strength of a relationship between two variables) between the two variables was 0.520, which indicates a moderately strong association between the two variables. 

### PM_2.5 and Unemployment 

```{r}

## Unemployment graph

finalData |>
  ggplot(aes(x = Unemployment,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Unemployment (% of county)",
       y = "PM_2.5 Levels (ppm)",
       title = "PM_2.5 Levels vs. Unemployment in NY Counties")

## Unemployment regression

unemployment_reg <- lm(PM ~ Unemployment, data = finalData)
unemployment_reg

## Unemployment correlation 

cor(finalData$Unemployment, finalData$PM)

```
From the graph, there seems to be a positive correlation between Unemployment and PM_2.5 levels. This can be seen through the line of best fit. Generally, as unemployment levels increase, PM_2.5 levels also increase. The regression further supports this observation. The coefficient for this regression is 0.2265, which means that as unemployment increases by 1 unit (1 percent), PM_2.5 levels increase by 0.2265 ppm. However, the correlation coefficient between the two variables is about 0.344, which indicates a weak association between the two variables. This reflects a weak strength to the relationship between Unemployment and PM_2.5. 

### PM_2.5 and Median Income

```{r}

## Median Income graph

finalData |>
  ggplot(aes(x = MedianIncome,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Median Household Income (dollars)",
       y = "PM_2.5 Levels (ppm)",
       title = "PM_2.5 Levels vs. Median Household Income in NY Counties")

## Median Income regression

income_reg <- lm(PM ~ MedianIncome, data = finalData)
income_reg

## Median Income correlation 

cor(finalData$MedianIncome, finalData$PM)

```
From the line of best fit, there seems to be a positive relationship between Median Household Income and PM_2.5 levels. Generally, as Median Household Income increases, PM_2.5 levels tend to increase. Though, the strength relationship does not appear to as strong as the relationships for Population Density and  Unemployment. The coefficient for the regression is 2.578e-05 or (0.00002578), which means that as Median Household Income increases by 1 unit (1 dollar), PM_2.5 levels increase by 2.578e-05 ppm. This number is small, but this was expected due to the large range in values for Median Household Income, in a similar way to Population Density. Finally, the correlation coefficient between Median Household Income and PM_2.5 levels was about 0.253, which indicates a weak strength of relationship, supporting the earlier conclusion. 

### PM_2.5 and Education

```{r}

## Education graph

finalData |>
  ggplot(aes(x = CollegeDegree,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Proportion of County with College Degree or Higher",
       y = "PM_2.5 Levels (ppm)",
       title = "PM_2.5 Levels vs. Education in NY Counties")

## Education regression

income_reg <- lm(PM ~ CollegeDegree, data = finalData)
income_reg

## Education correlation 

cor(finalData$CollegeDegree, finalData$PM)

```
From the line of best fit, there appears to be a positive relationship between Education levels and PM_2.5 levels. That is, as the proportion of a county with a college degree or higher increases, PM_2.5 levels tend to increase. The regression supports this observation, as the regression coefficient is 5.040. This means that as Education increases by 1 unit (1 additional percentage of the county with a college degree or higher), PM_2.5 levels increase by 5.040 ppm. Finally, the correlation coefficient between the two variables is about 0.458 which indicated a moderately strong relationship between them. 


### PM_2.5 and Poverty

```{r}

## Poverty graph

finalData |>
  ggplot(aes(x = Poverty,
             y = PM)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, 
              color = "indianred1", size = 1.5) +
  labs(x = "Poverty (% of county below poverty line)",
       y = "PM_2.5 Levels (ppm)",
       title = "PM_2.5 Levels vs. Poverty in NY Counties")

## poverty regression

income_reg <- lm(PM ~ Poverty, data = finalData)
income_reg

## correlation 

cor(finalData$Poverty, finalData$PM)

```
From the nearly horizontal line of best fit, there appears to be little correlation between Poverty and PM_2.5 levels, especially in comparison to the other variables. That is, an increase in poverty levels is not really associated with any change in PM_2.5 levels. However, there does appear to be a very minor positive relationship. The regression coefficient supports this observation, as it is 0.028. This means that as Poverty increases by 1 unit (1 additional percentage of the county below the poverty line), PM_2.5 levels increase by 0.028 ppm. Finally, the correlation coefficient between the two variables is about 0.085, which indicates a very weak association between them. This is the smallest correlation coefficient out of all of the relationships analyzed so far.

### Multiple Regression

```{r}

## Multiple regression

multi_reg <- lm(PM ~ Unemployment + MedianIncome + CollegeDegree + Poverty + PopDensity, data = finalData)
multi_reg

## Creating table

install.packages("modelsummary", repos = "http://cran.us.r-project.org")
library(modelsummary)

modelsummary::modelsummary(multi_reg,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))

```

